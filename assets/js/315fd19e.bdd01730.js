"use strict";(globalThis.webpackChunkai_book=globalThis.webpackChunkai_book||[]).push([[9321],{6697:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>p,frontMatter:()=>r,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"module1-ros2/building-ros2-packages","title":"Building ROS 2 Packages (Python)","description":"Structuring Your Robot Software","source":"@site/docs/module1-ros2/building-ros2-packages.md","sourceDirName":"module1-ros2","slug":"/module1-ros2/building-ros2-packages","permalink":"/physical-ai-robotics-book/module1-ros2/building-ros2-packages","draft":false,"unlisted":false,"editUrl":"https://github.com/your-username/physical-ai-robotics-book/edit/main/docs/module1-ros2/building-ros2-packages.md","tags":[],"version":"current","frontMatter":{},"sidebar":"bookSidebar","previous":{"title":"Chapter 5: Nodes, Topics, Services, Actions","permalink":"/physical-ai-robotics-book/module1-ros2/nodes-topics-services-actions"},"next":{"title":"Chapter 7: URDF and Robot Description","permalink":"/physical-ai-robotics-book/module1-ros2/urdf-and-robot-description"}}');var a=s(4848),i=s(8453);const r={},c="Building ROS 2 Packages (Python)",t={},d=[{value:"Structuring Your Robot Software",id:"structuring-your-robot-software",level:2},{value:"1. Creating a New ROS 2 Package",id:"1-creating-a-new-ros-2-package",level:3},{value:"2. Defining Custom Messages, Services, and Actions",id:"2-defining-custom-messages-services-and-actions",level:3},{value:"Custom Message Example (<code>my_ros2_package/msg/CustomPosition.msg</code>)",id:"custom-message-example-my_ros2_packagemsgcustompositionmsg",level:4},{value:"Custom Service Example (<code>my_ros2_package/srv/SetLed.srv</code>)",id:"custom-service-example-my_ros2_packagesrvsetledsrv",level:4},{value:"Custom Action Example (<code>my_ros2_package/action/MoveRobot.action</code>)",id:"custom-action-example-my_ros2_packageactionmoverobotaction",level:4},{value:"3. Updating <code>package.xml</code>",id:"3-updating-packagexml",level:3},{value:"4. Updating <code>setup.py</code>",id:"4-updating-setuppy",level:3},{value:"5. Building and Installing Your Package",id:"5-building-and-installing-your-package",level:3},{value:"Next Steps",id:"next-steps",level:3}];function l(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"building-ros-2-packages-python",children:"Building ROS 2 Packages (Python)"})}),"\n",(0,a.jsx)(n.h2,{id:"structuring-your-robot-software",children:"Structuring Your Robot Software"}),"\n",(0,a.jsxs)(n.p,{children:["In ROS 2, a ",(0,a.jsx)(n.strong,{children:"package"})," is the fundamental unit for organizing your code. It's a directory containing source code, data, dependencies, and configuration files that together provide specific functionality. This chapter will guide you through creating a new ROS 2 package in Python, defining custom message types, and configuring it for building and installation."]}),"\n",(0,a.jsx)(n.h3,{id:"1-creating-a-new-ros-2-package",children:"1. Creating a New ROS 2 Package"}),"\n",(0,a.jsxs)(n.p,{children:["We'll use ",(0,a.jsx)(n.code,{children:"ros2 pkg create"})," to generate the basic structure for a Python package."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Navigate to your ROS 2 workspace src directory (e.g., ~/ros2_ws/src)\ncd ~/ros2_ws/src\n\n# Create a new Python package named 'my_ros2_package'\nros2 pkg create --build-type ament_python my_ros2_package\n"})}),"\n",(0,a.jsxs)(n.p,{children:["This command creates a directory ",(0,a.jsx)(n.code,{children:"my_ros2_package"})," with the following basic structure:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"my_ros2_package/\n\u251c\u2500\u2500 my_ros2_package/\n\u2502   \u2514\u2500\u2500 __init__.py\n\u251c\u2500\u2500 package.xml\n\u2514\u2500\u2500 setup.py\n"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"my_ros2_package/"}),": This inner directory will hold your Python modules."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"__init__.py"}),": Marks the directory as a Python package."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"package.xml"}),": Defines package metadata, dependencies, and build information."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"setup.py"}),": The Python build script for installing your package's Python modules and entry points."]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"2-defining-custom-messages-services-and-actions",children:"2. Defining Custom Messages, Services, and Actions"}),"\n",(0,a.jsxs)(n.p,{children:["While standard ROS 2 messages (",(0,a.jsx)(n.code,{children:"std_msgs"}),") are useful, you'll often need to define custom data types for your application. These are defined in ",(0,a.jsx)(n.code,{children:".msg"}),", ",(0,a.jsx)(n.code,{children:".srv"}),", and ",(0,a.jsx)(n.code,{children:".action"})," files."]}),"\n",(0,a.jsxs)(n.h4,{id:"custom-message-example-my_ros2_packagemsgcustompositionmsg",children:["Custom Message Example (",(0,a.jsx)(n.code,{children:"my_ros2_package/msg/CustomPosition.msg"}),")"]}),"\n",(0,a.jsx)(n.p,{children:"Let's say we want a message to represent a 3D position with an associated ID."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"# CustomPosition.msg\nint32 id\nfloat64 x\nfloat64 y\nfloat64 z\n"})}),"\n",(0,a.jsxs)(n.h4,{id:"custom-service-example-my_ros2_packagesrvsetledsrv",children:["Custom Service Example (",(0,a.jsx)(n.code,{children:"my_ros2_package/srv/SetLed.srv"}),")"]}),"\n",(0,a.jsx)(n.p,{children:"A service to set the state of an LED and get a success response."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"# SetLed.srv\nint32 led_number\nbool state\n---\nbool success\nstring message\n"})}),"\n",(0,a.jsxs)(n.h4,{id:"custom-action-example-my_ros2_packageactionmoverobotaction",children:["Custom Action Example (",(0,a.jsx)(n.code,{children:"my_ros2_package/action/MoveRobot.action"}),")"]}),"\n",(0,a.jsx)(n.p,{children:"An action to move a robot to a target position, providing feedback along the way."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"# MoveRobot.action\nfloat32 target_x\nfloat32 target_y\nfloat32 target_z\n---\nbool success\nfloat32 final_x\nfloat32 final_y\nfloat32 final_z\n---\nfloat32 current_x\nfloat32 current_y\nfloat32 current_z\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Place these files in ",(0,a.jsx)(n.code,{children:"my_ros2_package/msg"}),", ",(0,a.jsx)(n.code,{children:"my_ros2_package/srv"}),", and ",(0,a.jsx)(n.code,{children:"my_ros2_package/action"})," directories (you'll need to create these directories)."]}),"\n",(0,a.jsxs)(n.h3,{id:"3-updating-packagexml",children:["3. Updating ",(0,a.jsx)(n.code,{children:"package.xml"})]}),"\n",(0,a.jsxs)(n.p,{children:["You need to tell ROS 2 that your package defines custom messages, services, and actions, and that it depends on ",(0,a.jsx)(n.code,{children:"rosidl_default_generators"})," to generate the necessary code."]}),"\n",(0,a.jsxs)(n.p,{children:["Add the following lines inside the ",(0,a.jsx)(n.code,{children:"<build_depend>"})," and ",(0,a.jsx)(n.code,{children:"<exec_depend>"})," sections of your ",(0,a.jsx)(n.code,{children:"package.xml"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:"  <build_depend>rosidl_default_generators</build_depend>\n  <exec_depend>rosidl_default_runtime</exec_depend>\n  <member_of_group>rosidl_interface_packages</member_of_group>\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Also, ensure you declare a dependency on ",(0,a.jsx)(n.code,{children:"std_msgs"})," if you plan to use standard messages."]}),"\n",(0,a.jsxs)(n.h3,{id:"4-updating-setuppy",children:["4. Updating ",(0,a.jsx)(n.code,{children:"setup.py"})]}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"setup.py"})," script is crucial for building and installing your Python package. For custom message types, you need to configure ",(0,a.jsx)(n.code,{children:"setup.py"})," to tell ROS 2's build system (",(0,a.jsx)(n.code,{children:"ament"}),") about them."]}),"\n",(0,a.jsxs)(n.p,{children:["Open ",(0,a.jsx)(n.code,{children:"setup.py"})," and modify it as follows:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"from setuptools import find_packages, setup\nimport os\nfrom glob import glob\n\npackage_name = 'my_ros2_package'\n\nsetup(\n    name=package_name,\n    version='0.0.0',\n    packages=find_packages(exclude=['test']),\n    data_files=[\n        ('share/' + package_name, ['package.xml']),\n        ('share/' + package_name + '/launch', glob(os.path.join('launch', '*launch.[pxy][yeml]'))), # Example for launch files\n        # Add these lines for custom messages, services, actions\n        (os.path.join('share', package_name, 'msg'), glob('msg/*.msg')),\n        (os.path.join('share', package_name, 'srv'), glob('srv/*.srv')),\n        (os.path.join('share', package_name, 'action'), glob('action/*.action')),\n    ],\n    install_requires=['setuptools'],\n    zip_safe=True,\n    maintainer='your_name',\n    maintainer_email='your_email@example.com',\n    description='TODO: Package description',\n    license='TODO: License declaration',\n    tests_require=['pytest'],\n    entry_points={\n        'console_scripts': [\n            # Add entry points for your nodes here, e.g.:\n            # 'my_node = my_ros2_package.my_node:main',\n        ],\n    },\n)\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsxs)(n.strong,{children:["Key additions to ",(0,a.jsx)(n.code,{children:"setup.py"}),":"]})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"data_files"}),": This section ensures that your ",(0,a.jsx)(n.code,{children:".msg"}),", ",(0,a.jsx)(n.code,{children:".srv"}),", and ",(0,a.jsx)(n.code,{children:".action"})," files are installed correctly so ",(0,a.jsx)(n.code,{children:"rosidl_default_generators"})," can find them and generate the corresponding Python code."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"entry_points"}),": This is where you declare your executable Python scripts (nodes) so they can be run using ",(0,a.jsx)(n.code,{children:"ros2 run"}),"."]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"5-building-and-installing-your-package",children:"5. Building and Installing Your Package"}),"\n",(0,a.jsxs)(n.p,{children:["Once ",(0,a.jsx)(n.code,{children:"package.xml"})," and ",(0,a.jsx)(n.code,{children:"setup.py"})," are configured, navigate back to your workspace root (",(0,a.jsx)(n.code,{children:"~/ros2_ws/"}),") and build your package:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\ncolcon build --packages-select my_ros2_package\n"})}),"\n",(0,a.jsx)(n.p,{children:"After a successful build, you need to source your workspace to make the new package available in your environment:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"source install/setup.bash # or setup.zsh for Zsh users\n"})}),"\n",(0,a.jsx)(n.p,{children:"Now, you can check if your custom interfaces were generated:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ros2 interface show my_ros2_package/msg/CustomPosition\nros2 interface show my_ros2_package/srv/SetLed\nros2 interface show my_ros2_package/action/MoveRobot\n"})}),"\n",(0,a.jsxs)(n.p,{children:["You can also run any nodes you defined in ",(0,a.jsx)(n.code,{children:"entry_points"})," of ",(0,a.jsx)(n.code,{children:"setup.py"}),"."]}),"\n",(0,a.jsx)(n.h3,{id:"next-steps",children:"Next Steps"}),"\n",(0,a.jsx)(n.p,{children:"With your package created and custom interfaces defined, you're ready to start implementing complex robot behaviors using these new data types. The next chapter will cover how to describe your robot's physical structure using URDF."})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>c});var o=s(6540);const a={},i=o.createContext(a);function r(e){const n=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);